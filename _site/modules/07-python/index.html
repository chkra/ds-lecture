<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Working with Data: Python and the Pandas Library -</title>
<meta name="description" content="Neue Impulse für die KI-Lehre">


  <meta name="author" content="Christina Kratsch">
  


<meta property="og:type" content="website">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="">
<meta property="og:title" content="Working with Data: Python and the Pandas Library">
<meta property="og:url" content="http://localhost:4000/modules/07-python/">


  <meta property="og:description" content="Neue Impulse für die KI-Lehre">











  

  


<link rel="canonical" href="http://localhost:4000/modules/07-python/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "",
      "url": "http://localhost:4000/"
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title=" Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/logo.png" alt=""></a>
        
        <a class="site-title" href="/">
          
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="https://mmistakes.github.io/minimal-mistakes/docs/quick-start-guide/">Quick-Start Guide</a>
            </li><li class="masthead__menu-item">
              <a href="https://mmistakes.github.io/minimal-mistakes/about/">About</a>
            </li><li class="masthead__menu-item">
              <a href="/year-archive/">Sample Posts</a>
            </li><li class="masthead__menu-item">
              <a href="/collection-archive/">Sample Collections</a>
            </li><li class="masthead__menu-item">
              <a href="/sitemap/">Sitemap</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      





<div id="main" role="main">
  
  <div class="sidebar sticky">
  



<div style="color: #76B900;margin-bottom:-10px;font-weight: bold;"><h3>Data Science</h3></div>

<div style="color: #858585;font-size:small;">Grundlegende Methoden für die Exploration und das Management von Daten.</div>




<a href="https://creativecommons.org/licenses/by/4.0/">
  <img style="height: 15px; width: 80px;" src="https://licensebuttons.net/l/by/4.0/80x15.png">
</a>


<div style="color: #858585;font-size:small;margin-top: -15px;">2024 | HTW Berlin</div>




<div itemscope itemtype="https://schema.org/Person" class="h-card">

  
    <div class="author__avatar">
      <a href="http://localhost:4000/">
        <img src="/assets/images/authors/ck.png" alt="Christina Kratsch" itemprop="image" class="u-photo">
      </a>
    </div>
  

  <div class="author__content">
    <div class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="http://localhost:4000/" itemprop="url">Christina Kratsch</a>
    </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      
        
          
            <li><a href="mailto:kratsch@htw-berlin.de" rel="nofollow noopener noreferrer me"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span></a></li>
          
        
          
            <li><a href="https://www.htw-berlin.de/hochschule/personen/person/?eid=13856" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">Website</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page h-entry" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Working with Data: Python and the Pandas Library">
    
    
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title p-name" itemprop="headline">
            <a href="http://localhost:4000/modules/07-python/" class="u-url" itemprop="url">Working with Data: Python and the Pandas Library
</a>
          </h1>
          


        </header>
      

      <section class="page__content e-content" itemprop="text">
        
        <p>While databases offer very efficient ways to store data and query them using query languages, the most flexible way of data processing is writing your own program to manipulate data. In many cases, doing a database query would be a more effective way. However in some cases when more complex data processing is needed, it cannot be done easily using SQL. 
Data processing can be programmed in any programming language, but there are certain languages that are higher level with respect to working with data. Data scientists typically prefer one of the following languages:</p>

<ul>
  <li><strong><a href="https://www.python.org/">Python</a></strong>, a general-purpose programming language, which is often considered one of the best options for beginners due to its simplicity. Python has a lot of additional libraries that can help you solve many practical problems, such as extracting your data from ZIP archive, or converting picture to grayscale. In addition to data science, Python is also often used for web development.</li>
  <li><strong><a href="https://www.r-project.org/">R</a></strong> is a traditional toolbox developed with statistical data processing in mind. It also contains large repository of libraries (CRAN), making it a good choice for data processing. However, R is not a general-purpose programming language, and is rarely used outside of data science domain.</li>
  <li><strong><a href="https://julialang.org/">Julia</a></strong> is another language developed specifically for data science. It is intended to give better performance than Python, making it a great tool for scientific experimentation.</li>
</ul>

<p>In this lesson, we will focus on using Python for simple data processing. We will assume basic familiarity with the language. If you want a deeper tour of Python, you can refer to one of the following resources:</p>

<ul>
  <li><a href="https://github.com/shwars/pycourse">Learn Python in a Fun Way with Turtle Graphics and Fractals</a> - GitHub-based quick intro course into Python Programming</li>
  <li><a href="https://docs.microsoft.com/en-us/learn/paths/python-first-steps/?WT.mc_id=academic-77958-bethanycheum">Take your First Steps with Python</a> Learning Path on <a href="http://learn.microsoft.com/?WT.mc_id=academic-77958-bethanycheum">Microsoft Learn</a></li>
</ul>

<p>Data can come in many forms. In this lesson, we will consider three forms of data - <strong>tabular data</strong>, <strong>text</strong> and <strong>images</strong>.</p>

<p>We will focus on a few examples of data processing, instead of giving you full overview of all related libraries. This would allow you to get the main idea of what’s possible, and leave you with understanding on where to find solutions to your problems when you need them.</p>

<blockquote>
  <p><strong>Most useful advice</strong>. When you need to perform certain operation on data that you do not know how to do, try searching for it in the internet. <a href="https://stackoverflow.com/">Stackoverflow</a> usually contains a lot of useful code sample in Python for many typical tasks.</p>
</blockquote>

<h2 id="tabular-data-and-dataframes">Tabular Data and Dataframes</h2>

<p>You have already met tabular data when we talked about relational databases. When you have a lot of data, and it is contained in many different linked tables, it definitely makes sense to use SQL for working with it. However, there are many cases when we have a table of data, and we need to gain some <strong>understanding</strong> or <strong>insights</strong> about this data, such as the distribution, correlation between values, etc. In data science, there are a lot of cases when we need to perform some transformations of the original data, followed by visualization. Both those steps can be easily done using Python.</p>

<p>There are two most useful libraries in Python that can help you deal with tabular data:</p>
<ul>
  <li><strong><a href="https://pandas.pydata.org/">Pandas</a></strong> allows you to manipulate so-called <strong>Dataframes</strong>, which are analogous to relational tables. You can have named columns, and perform different operations on row, columns and dataframes in general.</li>
  <li><strong><a href="https://numpy.org/">Numpy</a></strong> is a library for working with <strong>tensors</strong>, i.e. multi-dimensional <strong>arrays</strong>. Array has values of the same underlying type, and it is simpler than dataframe, but it offers more mathematical operations, and creates less overhead.</li>
</ul>

<p>There are also a couple of other libraries you should know about:</p>
<ul>
  <li><strong><a href="https://matplotlib.org/">Matplotlib</a></strong> is a library used for data visualization and plotting graphs</li>
  <li><strong><a href="https://www.scipy.org/">SciPy</a></strong> is a library with some additional scientific functions. We have already come across this library when talking about probability and statistics</li>
</ul>

<p>Here is a piece of code that you would typically use to import those libraries in the beginning of your Python program:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="n">scipy</span> <span class="kn">import</span> <span class="p">...</span> <span class="c1"># you need to specify exact sub-packages that you need
</span></code></pre></div></div>

<p>Pandas is centered around a few basic concepts.</p>

<h3 id="series">Series</h3>

<p><strong>Series</strong> is a sequence of values, similar to a list or numpy array. The main difference is that series also has an <strong>index</strong>, and when we operate on series (eg., add them), the index is taken into account. Index can be as simple as integer row number (it is the index used by default when creating a series from list or array), or it can have a complex structure, such as date interval.</p>

<blockquote>
  <p><strong>Note</strong>: There is some introductory Pandas code in the accompanying notebook <a href="/modules/07-python/notebook.ipynb"><code class="language-plaintext highlighter-rouge">notebook.ipynb</code></a>. We only outline some the examples here, and you are definitely welcome to check out the full notebook.</p>
</blockquote>

<p>Consider an example: we want to analyze sales of our ice-cream spot. Let’s generate a series of sales numbers (number of items sold each day) for some time period:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">start_date</span> <span class="o">=</span> <span class="sh">"</span><span class="s">Jan 1, 2020</span><span class="sh">"</span>
<span class="n">end_date</span> <span class="o">=</span> <span class="sh">"</span><span class="s">Mar 31, 2020</span><span class="sh">"</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">date_range</span><span class="p">(</span><span class="n">start_date</span><span class="p">,</span><span class="n">end_date</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Length of index is </span><span class="si">{</span><span class="nf">len</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="n">items_sold</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">Series</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">randint</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="nf">len</span><span class="p">(</span><span class="n">idx</span><span class="p">)),</span><span class="n">index</span><span class="o">=</span><span class="n">idx</span><span class="p">)</span>
<span class="n">items_sold</span><span class="p">.</span><span class="nf">plot</span><span class="p">()</span>
</code></pre></div></div>
<p><img src="/modules/07-python/images/timeseries-1.png" alt="Time Series Plot" /></p>

<p>Now suppose that each week we are organizing a party for friends, and we take additional 10 packs of ice-cream for a party. We can create another series, indexed by week, to demonstrate that:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">additional_items</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">Series</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="p">.</span><span class="nf">date_range</span><span class="p">(</span><span class="n">start_date</span><span class="p">,</span><span class="n">end_date</span><span class="p">,</span><span class="n">freq</span><span class="o">=</span><span class="sh">"</span><span class="s">W</span><span class="sh">"</span><span class="p">))</span>
</code></pre></div></div>
<p>When we add two series together, we get total number:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">total_items</span> <span class="o">=</span> <span class="n">items_sold</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">additional_items</span><span class="p">,</span><span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">total_items</span><span class="p">.</span><span class="nf">plot</span><span class="p">()</span>
</code></pre></div></div>
<p><img src="/modules/07-python/images/timeseries-2.png" alt="Time Series Plot" /></p>

<blockquote>
  <p><strong>Note</strong> that we are not using simple syntax <code class="language-plaintext highlighter-rouge">total_items+additional_items</code>. If we did, we would have received a lot of <code class="language-plaintext highlighter-rouge">NaN</code> (<em>Not a Number</em>) values in the resulting series. This is because there are missing values for some of the index point in the <code class="language-plaintext highlighter-rouge">additional_items</code> series, and adding <code class="language-plaintext highlighter-rouge">Nan</code> to anything results in <code class="language-plaintext highlighter-rouge">NaN</code>. Thus we need to specify <code class="language-plaintext highlighter-rouge">fill_value</code> parameter during addition.</p>
</blockquote>

<p>With time series, we can also <strong>resample</strong> the series with different time intervals. For example, suppose we want to compute mean sales volume monthly. We can use the following code:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">monthly</span> <span class="o">=</span> <span class="n">total_items</span><span class="p">.</span><span class="nf">resample</span><span class="p">(</span><span class="sh">"</span><span class="s">1M</span><span class="sh">"</span><span class="p">).</span><span class="nf">mean</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">monthly</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="sh">'</span><span class="s">bar</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div>
<p><img src="/modules/07-python/images/timeseries-3.png" alt="Monthly Time Series Averages" /></p>

<h3 id="dataframe">DataFrame</h3>

<p>A DataFrame is essentially a collection of series with the same index. We can combine several series together into a DataFrame:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">a</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">Series</span><span class="p">(</span><span class="nf">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">Series</span><span class="p">([</span><span class="sh">"</span><span class="s">I</span><span class="sh">"</span><span class="p">,</span><span class="sh">"</span><span class="s">like</span><span class="sh">"</span><span class="p">,</span><span class="sh">"</span><span class="s">to</span><span class="sh">"</span><span class="p">,</span><span class="sh">"</span><span class="s">play</span><span class="sh">"</span><span class="p">,</span><span class="sh">"</span><span class="s">games</span><span class="sh">"</span><span class="p">,</span><span class="sh">"</span><span class="s">and</span><span class="sh">"</span><span class="p">,</span><span class="sh">"</span><span class="s">will</span><span class="sh">"</span><span class="p">,</span><span class="sh">"</span><span class="s">not</span><span class="sh">"</span><span class="p">,</span><span class="sh">"</span><span class="s">change</span><span class="sh">"</span><span class="p">],</span><span class="n">index</span><span class="o">=</span><span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">))</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">([</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">])</span>
</code></pre></div></div>
<p>This will create a horizontal table like this:
|     | 0   | 1    | 2   | 3   | 4      | 5   | 6      | 7    | 8    |
| — | — | —- | — | — | —— | — | —— | —- | —- |
| 0   | 1   | 2    | 3   | 4   | 5      | 6   | 7      | 8    | 9    |
| 1   | I   | like | to  | use | Python | and | Pandas | very | much |</p>

<p>We can also use Series as columns, and specify column names using dictionary:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">({</span> <span class="sh">'</span><span class="s">A</span><span class="sh">'</span> <span class="p">:</span> <span class="n">a</span><span class="p">,</span> <span class="sh">'</span><span class="s">B</span><span class="sh">'</span> <span class="p">:</span> <span class="n">b</span> <span class="p">})</span>
</code></pre></div></div>
<p>This will give us a table like this:</p>

<table>
  <thead>
    <tr>
      <th> </th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1</td>
      <td>I</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>like</td>
    </tr>
    <tr>
      <td>2</td>
      <td>3</td>
      <td>to</td>
    </tr>
    <tr>
      <td>3</td>
      <td>4</td>
      <td>use</td>
    </tr>
    <tr>
      <td>4</td>
      <td>5</td>
      <td>Python</td>
    </tr>
    <tr>
      <td>5</td>
      <td>6</td>
      <td>and</td>
    </tr>
    <tr>
      <td>6</td>
      <td>7</td>
      <td>Pandas</td>
    </tr>
    <tr>
      <td>7</td>
      <td>8</td>
      <td>very</td>
    </tr>
    <tr>
      <td>8</td>
      <td>9</td>
      <td>much</td>
    </tr>
  </tbody>
</table>

<p><strong>Note</strong> that we can also get this table layout by transposing the previous table, eg. by writing</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">([</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]).</span><span class="n">T</span><span class="p">..</span><span class="nf">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span> <span class="mi">0</span> <span class="p">:</span> <span class="sh">'</span><span class="s">A</span><span class="sh">'</span><span class="p">,</span> <span class="mi">1</span> <span class="p">:</span> <span class="sh">'</span><span class="s">B</span><span class="sh">'</span> <span class="p">})</span>
</code></pre></div></div>
<p>Here <code class="language-plaintext highlighter-rouge">.T</code> means the operation of transposing the DataFrame, i.e. changing rows and columns, and <code class="language-plaintext highlighter-rouge">rename</code> operation allows us to rename columns to match the previous example.</p>

<p>Here are a few most important operations we can perform on DataFrames:</p>

<p><strong>Column selection</strong>. We can select individual columns by writing <code class="language-plaintext highlighter-rouge">df['A']</code> - this operation returns a Series. We can also select a subset of columns into another DataFrame by writing <code class="language-plaintext highlighter-rouge">df[['B','A']]</code> - this return another DataFrame.</p>

<p><strong>Filtering</strong> only certain rows by criteria. For example, to leave only rows with column <code class="language-plaintext highlighter-rouge">A</code> greater than 5, we can write <code class="language-plaintext highlighter-rouge">df[df['A']&gt;5]</code>.</p>

<blockquote>
  <p><strong>Note</strong>: The way filtering works is the following. The expression <code class="language-plaintext highlighter-rouge">df['A']&lt;5</code> returns a boolean series, which indicates whether expression is <code class="language-plaintext highlighter-rouge">True</code> or <code class="language-plaintext highlighter-rouge">False</code> for each element of the original series <code class="language-plaintext highlighter-rouge">df['A']</code>. When boolean series is used as an index, it returns subset of rows in the DataFrame. Thus it is not possible to use arbitrary Python boolean expression, for example, writing <code class="language-plaintext highlighter-rouge">df[df['A']&gt;5 and df['A']&lt;7]</code> would be wrong. Instead, you should use special <code class="language-plaintext highlighter-rouge">&amp;</code> operation on boolean series, writing <code class="language-plaintext highlighter-rouge">df[(df['A']&gt;5) &amp; (df['A']&lt;7)]</code> (<em>brackets are important here</em>).</p>
</blockquote>

<p><strong>Creating new computable columns</strong>. We can easily create new computable columns for our DataFrame by using intuitive expression like this:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">DivA</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">A</span><span class="sh">'</span><span class="p">]</span><span class="o">-</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">A</span><span class="sh">'</span><span class="p">].</span><span class="nf">mean</span><span class="p">()</span> 
</code></pre></div></div>
<p>This example calculates divergence of A from its mean value. What actually happens here is we are computing a series, and then assigning this series to the left-hand-side, creating another column. Thus, we cannot use any operations that are not compatible with series, for example, the code below is wrong:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Wrong code -&gt; df['ADescr'] = "Low" if df['A'] &lt; 5 else "Hi"
</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">LenB</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">B</span><span class="sh">'</span><span class="p">])</span> <span class="c1"># &lt;- Wrong result
</span></code></pre></div></div>
<p>The latter example, while being syntactically correct, gives us wrong result, because it assigns the length of series <code class="language-plaintext highlighter-rouge">B</code> to all values in the column, and not the length of individual elements as we intended.</p>

<p>If we need to compute complex expressions like this, we can use <code class="language-plaintext highlighter-rouge">apply</code> function. The last example can be written as follows:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">LenB</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">B</span><span class="sh">'</span><span class="p">].</span><span class="nf">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="nf">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="c1"># or 
</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">LenB</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">B</span><span class="sh">'</span><span class="p">].</span><span class="nf">apply</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span>
</code></pre></div></div>

<p>After operations above, we will end up with the following DataFrame:</p>

<table>
  <thead>
    <tr>
      <th> </th>
      <th>A</th>
      <th>B</th>
      <th>DivA</th>
      <th>LenB</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1</td>
      <td>I</td>
      <td>-4.0</td>
      <td>1</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>like</td>
      <td>-3.0</td>
      <td>4</td>
    </tr>
    <tr>
      <td>2</td>
      <td>3</td>
      <td>to</td>
      <td>-2.0</td>
      <td>2</td>
    </tr>
    <tr>
      <td>3</td>
      <td>4</td>
      <td>use</td>
      <td>-1.0</td>
      <td>3</td>
    </tr>
    <tr>
      <td>4</td>
      <td>5</td>
      <td>Python</td>
      <td>0.0</td>
      <td>6</td>
    </tr>
    <tr>
      <td>5</td>
      <td>6</td>
      <td>and</td>
      <td>1.0</td>
      <td>3</td>
    </tr>
    <tr>
      <td>6</td>
      <td>7</td>
      <td>Pandas</td>
      <td>2.0</td>
      <td>6</td>
    </tr>
    <tr>
      <td>7</td>
      <td>8</td>
      <td>very</td>
      <td>3.0</td>
      <td>4</td>
    </tr>
    <tr>
      <td>8</td>
      <td>9</td>
      <td>much</td>
      <td>4.0</td>
      <td>4</td>
    </tr>
  </tbody>
</table>

<p><strong>Selecting rows based on numbers</strong> can be done using <code class="language-plaintext highlighter-rouge">iloc</code> construct. For example, to select first 5 rows from the DataFrame:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</code></pre></div></div>

<p><strong>Grouping</strong> is often used to get a result similar to <em>pivot tables</em> in Excel. Suppose that we want to compute mean value of column <code class="language-plaintext highlighter-rouge">A</code> for each given number of <code class="language-plaintext highlighter-rouge">LenB</code>. Then we can group our DataFrame by <code class="language-plaintext highlighter-rouge">LenB</code>, and call <code class="language-plaintext highlighter-rouge">mean</code>:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="nf">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="sh">'</span><span class="s">LenB</span><span class="sh">'</span><span class="p">).</span><span class="nf">mean</span><span class="p">()</span>
</code></pre></div></div>
<p>If we need to compute mean and the number of elements in the group, then we can use more complex <code class="language-plaintext highlighter-rouge">aggregate</code> function:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="nf">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="sh">'</span><span class="s">LenB</span><span class="sh">'</span><span class="p">)</span> \
 <span class="p">.</span><span class="nf">aggregate</span><span class="p">({</span> <span class="sh">'</span><span class="s">DivA</span><span class="sh">'</span> <span class="p">:</span> <span class="nb">len</span><span class="p">,</span> <span class="sh">'</span><span class="s">A</span><span class="sh">'</span> <span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">.</span><span class="nf">mean</span><span class="p">()</span> <span class="p">})</span> \
 <span class="p">.</span><span class="nf">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span> <span class="sh">'</span><span class="s">DivA</span><span class="sh">'</span> <span class="p">:</span> <span class="sh">'</span><span class="s">Count</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">A</span><span class="sh">'</span> <span class="p">:</span> <span class="sh">'</span><span class="s">Mean</span><span class="sh">'</span><span class="p">})</span>
</code></pre></div></div>
<p>This gives us the following table:</p>

<table>
  <thead>
    <tr>
      <th>LenB</th>
      <th>Count</th>
      <th>Mean</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>1</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1</td>
      <td>3.000000</td>
    </tr>
    <tr>
      <td>3</td>
      <td>2</td>
      <td>5.000000</td>
    </tr>
    <tr>
      <td>4</td>
      <td>3</td>
      <td>6.333333</td>
    </tr>
    <tr>
      <td>6</td>
      <td>2</td>
      <td>6.000000</td>
    </tr>
  </tbody>
</table>

<h3 id="getting-data">Getting Data</h3>

<p>We have seen how easy it is to construct Series and DataFrames from Python objects. However, data usually comes in the form of a text file, or an Excel table. Luckily, Pandas offers us a simple way to load data from disk. For example, reading CSV file is as simple as this:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">read_csv</span><span class="p">(</span><span class="sh">'</span><span class="s">file.csv</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="printing-and-plotting">Printing and Plotting</h3>

<p>A Data Scientist often has to explore the data, thus it is important to be able to visualize it. When DataFrame is big, many times we want just to make sure we are doing everything correctly by printing out the first few rows. This can be done by calling <code class="language-plaintext highlighter-rouge">df.head()</code>. If you are running it from Jupyter Notebook, it will print out the DataFrame in a nice tabular form.</p>

<p>We have also seen the usage of <code class="language-plaintext highlighter-rouge">plot</code> function to visualize some columns. While <code class="language-plaintext highlighter-rouge">plot</code> is very useful for many tasks, and supports many different graph types via <code class="language-plaintext highlighter-rouge">kind=</code> parameter, you can always use raw <code class="language-plaintext highlighter-rouge">matplotlib</code> library to plot something more complex. We will cover data visualization in detail in separate course lessons.</p>

<p>This overview covers most important concepts of Pandas, however, the library is very rich, and there is no limit to what you can do with it! Let’s now apply this knowledge for solving specific problem.</p>

<h2 id="working-with-unstructured-data">Working with Unstructured Data</h2>

<p>While data very often comes in tabular form, in some cases we need to deal with less structured data, for example, text or images. In this case, to apply data processing techniques we have seen above, we need to somehow <strong>extract</strong> structured data. Here are a few examples:</p>

<ul>
  <li>Extracting keywords from text, and seeing how often those keywords appear</li>
  <li>Using neural networks to extract information about objects on the picture</li>
  <li>Getting information on emotions of people on video camera feed</li>
</ul>

<h2 id="processing-image-data">Processing Image Data</h2>

<p>Recently, very powerful AI models have been developed that allow us to understand images. There are many tasks that can be solved using pre-trained neural networks, or cloud services. Some examples include:</p>

<ul>
  <li><strong>Image Classification</strong>, which can help you categorize the image into one of the pre-defined classes. You can easily train your own image classifiers using services such as <a href="https://azure.microsoft.com/services/cognitive-services/custom-vision-service/?WT.mc_id=academic-77958-bethanycheum">Custom Vision</a></li>
  <li><strong>Object Detection</strong> to detect different objects in the image. Services such as <a href="https://azure.microsoft.com/services/cognitive-services/computer-vision/?WT.mc_id=academic-77958-bethanycheum">computer vision</a> can detect a number of common objects, and you can train <a href="https://azure.microsoft.com/services/cognitive-services/custom-vision-service/?WT.mc_id=academic-77958-bethanycheum">Custom Vision</a> model to detect some specific objects of interest.</li>
  <li><strong>Face Detection</strong>, including Age, Gender and Emotion detection. This can be done via <a href="https://azure.microsoft.com/services/cognitive-services/face/?WT.mc_id=academic-77958-bethanycheum">Face API</a>.</li>
</ul>

<p>All those cloud services can be called using <a href="https://docs.microsoft.com/samples/azure-samples/cognitive-services-python-sdk-samples/cognitive-services-python-sdk-samples/?WT.mc_id=academic-77958-bethanycheum">Python SDKs</a>, and thus can be easily incorporated into your data exploration workflow.</p>

<p>Here are some examples of exploring data from Image data sources:</p>
<ul>
  <li>In the blog post <a href="https://soshnikov.com/azure/how-to-learn-data-science-without-coding/">How to Learn Data Science without Coding</a> we explore Instagram photos, trying to understand what makes people give more likes to a photo. We first extract as much information from pictures as possible using <a href="https://azure.microsoft.com/services/cognitive-services/computer-vision/?WT.mc_id=academic-77958-bethanycheum">computer vision</a>, and then use <a href="https://docs.microsoft.com/azure/machine-learning/concept-automated-ml/?WT.mc_id=academic-77958-bethanycheum">Azure Machine Learning AutoML</a> to build interpretable model.</li>
  <li>In <a href="https://github.com/CloudAdvocacy/FaceStudies">Facial Studies Workshop</a> we use <a href="https://azure.microsoft.com/services/cognitive-services/face/?WT.mc_id=academic-77958-bethanycheum">Face API</a> to extract emotions on people on photographs from events, in order to try to understand what makes people happy.</li>
</ul>

<h2 id="conclusion">Conclusion</h2>

<p>Whether you already have structured or unstructured data, using Python you can perform all steps related to data processing and understanding. It is probably the most flexible way of data processing, and that is the reason the majority of data scientists use Python as their primary tool. Learning Python in depth is probably a good idea if you are serious about your data science journey!</p>

<h2 id="credits">Credits</h2>

<p class="notice--info"><strong>⚑ References</strong> <br /> This lesson was taken from the course <a href="https://github.com/microsoft/Data-Science-For-Beginners">“Data Science for Beginners”</a>. It has been authored by <a href="http://soshnikov.com">Dmitry Soshnikov</a>.</p>

        
      </section>

      <footer class="page__meta">
        
        


        

      </footer>

      

      
    </div>

    
  </article>

  
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
      
        
      
        
      
        
      
        
      
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2024 . Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>










  </body>
</html>
